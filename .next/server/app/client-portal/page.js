(()=>{var e={};e.id=954,e.ids=[954],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7659:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var r=s(482),a=s(9108),i=s(2563),n=s.n(i),l=s(8300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["client-portal",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7897)),"/Users/sekharcidambi/flex-pay-tracker-saas/src/app/client-portal/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3625)),"/Users/sekharcidambi/flex-pay-tracker-saas/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,8206)),"/Users/sekharcidambi/flex-pay-tracker-saas/src/app/not-found.tsx"]}],c=["/Users/sekharcidambi/flex-pay-tracker-saas/src/app/client-portal/page.tsx"],u="/client-portal/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/client-portal/page",pathname:"/client-portal",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1748:(e,t,s)=>{Promise.resolve().then(s.bind(s,1423))},1423:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(5344),a=s(3729),i=s(853),n=s(594),l=s(3673),o=s(5094),d=s(9591),c=s(2690),u=s(6540),m=s(3668),x=s(4755),p=s(2400);function f(){let{user:e}=(0,i.a)(),[t,s]=(0,a.useState)([]),[f,g]=(0,a.useState)(null),[h,y]=(0,a.useState)([]),[b,v]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[w,_]=(0,a.useState)(!0);(0,a.useEffect)(()=>{q()},[e]),(0,a.useEffect)(()=>{f&&k(f.id)},[f]);let q=async()=>{try{let{data:t,error:r}=await n.O.from("invoices").select(`
          *,
          clients!inner (
            id,
            name,
            client_portal_access!inner (
              user_id
            )
          )
        `).eq("clients.client_portal_access.user_id",e?.id).order("created_at",{ascending:!1});if(r)throw r;s(t||[])}catch(e){x.toast.error("Failed to fetch invoices"),console.error(e)}finally{_(!1)}},k=async e=>{try{let{data:t,error:s}=await n.O.from("payments").select("*").eq("invoice_id",e).order("payment_date",{ascending:!1});if(s)throw s;y(t||[])}catch(e){console.error("Failed to fetch payments:",e)}},C=async()=>{if(!f||!b){x.toast.error("Please fill in all required fields");return}try{let{error:e}=await n.O.from("payments").insert({invoice_id:f.id,amount:f.total_amount,payment_method:b,client_comment:j,paid_by_client:!0});if(e)throw e;let{error:t}=await n.O.from("invoices").update({status:"paid"}).eq("id",f.id);if(t)throw t;x.toast.success("Payment recorded successfully!"),v(""),N(""),q(),k(f.id)}catch(e){x.toast.error("Failed to record payment"),console.error(e)}},M=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";case"sent":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return w?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your invoices..."})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Client Portal"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"View and manage your invoices"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Your Invoices"}),t.map(e=>(0,r.jsxs)(l.Zb,{className:`cursor-pointer transition-colors hover:bg-gray-50 ${f?.id===e.id?"ring-2 ring-blue-500":""}`,onClick:()=>g(e),children:[r.jsx(l.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[r.jsx(l.ll,{className:"text-lg",children:e.invoice_number}),r.jsx(l.SZ,{children:e.title})]}),r.jsx(d.C,{className:M(e.status),children:e.status})]})}),r.jsx(l.aY,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-2xl font-bold",children:["$",e.total_amount.toFixed(2)," ",e.currency]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Due: ",(0,p.WU)(new Date(e.due_date),"MMM dd, yyyy")]})]})})]},e.id))]}),r.jsx("div",{children:f?(0,r.jsxs)(l.Zb,{children:[(0,r.jsxs)(l.Ol,{children:[r.jsx(l.ll,{children:"Invoice Details"}),r.jsx(l.SZ,{children:f.title})]}),(0,r.jsxs)(l.aY,{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-semibold",children:"Amount:"}),(0,r.jsxs)("span",{children:["$",f.total_amount.toFixed(2)," ",f.currency]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-semibold",children:"Status:"}),r.jsx(d.C,{className:M(f.status),children:f.status})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-semibold",children:"Due Date:"}),r.jsx("span",{children:(0,p.WU)(new Date(f.due_date),"MMM dd, yyyy")})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-semibold",children:"Issued:"}),r.jsx("span",{children:(0,p.WU)(new Date(f.issue_date),"MMM dd, yyyy")})]})]}),"paid"!==f.status&&(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(m._,{htmlFor:"paymentMethod",children:"Payment Method"}),r.jsx(u.I,{id:"paymentMethod",value:b,onChange:e=>v(e.target.value),placeholder:"e.g. Bank Transfer, Credit Card",required:!0}),r.jsx(m._,{htmlFor:"paymentComment",children:"Comment (optional)"}),r.jsx(c.g,{id:"paymentComment",value:j,onChange:e=>N(e.target.value),placeholder:"Add a comment for the business..."}),r.jsx(o.z,{onClick:C,className:"w-full",children:"Mark as Paid"})]}),(0,r.jsxs)("div",{className:"mt-8",children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Payment History"}),0===h.length?r.jsx("p",{className:"text-gray-500",children:"No payments recorded yet."}):r.jsx("ul",{className:"space-y-2",children:h.map(e=>(0,r.jsxs)("li",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{children:["$",e.amount.toFixed(2)," via ",e.payment_method,e.client_comment&&(0,r.jsxs)("span",{className:"ml-2 text-xs text-gray-400",children:["(",e.client_comment,")"]})]}),r.jsx("span",{className:"text-sm text-gray-500",children:(0,p.WU)(new Date(e.payment_date),"MMM dd, yyyy")})]},e.id))})]})]})]}):r.jsx("div",{className:"text-gray-500",children:"Select an invoice to view details"})})]})]})})}},9591:(e,t,s)=>{"use strict";s.d(t,{C:()=>l});var r=s(5344);s(3729);var a=s(9247),i=s(1453);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...s}){return r.jsx("div",{className:(0,i.cn)(n({variant:t}),e),...s})}},5094:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var r=s(5344),a=s(3729),i=s(2751),n=s(9247),l=s(1453);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...n},d)=>{let c=a?i.g7:"button";return r.jsx(c,{className:(0,l.cn)(o({variant:t,size:s,className:e})),ref:d,...n})});d.displayName="Button"},3673:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>l,SZ:()=>d,Zb:()=>n,aY:()=>c,ll:()=>o});var r=s(5344),a=s(3729),i=s(1453);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let l=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=a.forwardRef(({className:e,...t},s)=>r.jsx("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=a.forwardRef(({className:e,...t},s)=>r.jsx("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},6540:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var r=s(5344),a=s(3729),i=s(1453);let n=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));n.displayName="Input"},3668:(e,t,s)=>{"use strict";s.d(t,{_:()=>c});var r=s(5344),a=s(3729),i=s(2409),n=a.forwardRef((e,t)=>(0,r.jsx)(i.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var l=s(9247),o=s(1453);let d=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(({className:e,...t},s)=>r.jsx(n,{ref:s,className:(0,o.cn)(d(),e),...t}));c.displayName=n.displayName},2690:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var r=s(5344),a=s(3729),i=s(1453);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));n.displayName="Textarea"},7897:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let r=(0,s(6843).createProxy)(String.raw`/Users/sekharcidambi/flex-pay-tracker-saas/src/app/client-portal/page.tsx`),{__esModule:a,$$typeof:i}=r,n=r.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[225,312,400,542],()=>s(7659));module.exports=r})();