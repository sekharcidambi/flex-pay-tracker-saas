"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{9943:function(e,t,s){s.d(t,{R:function(){return w}});var a=s(3827),r=s(4090),i=s(5671),n=s(575),l=s(2782),d=s(3277),o=s(94),c=s(8670),u=s(7841),m=s(9295),f=s(489),h=s(2647),x=s(8685),p=s(8641),v=s(9902),y=s(8494),g=s(6288);let j=e=>{let{invoice:t,onSave:s,onCancel:d}=e,{currentBusiness:c}=(0,y.i)(),[u,m]=(0,r.useState)([]),[j,b]=(0,r.useState)({client_id:(null==t?void 0:t.client_id)||"",title:(null==t?void 0:t.title)||"",description:(null==t?void 0:t.description)||"",due_date:(null==t?void 0:t.due_date)||"",issue_date:(null==t?void 0:t.issue_date)||new Date().toISOString().split("T")[0],payment_terms:(null==t?void 0:t.payment_terms)||"30 days",currency:(null==t?void 0:t.currency)||"USD",status:(null==t?void 0:t.status)||"draft",notes:(null==t?void 0:t.notes)||"",items:(null==t?void 0:t.items)||[{description:"",quantity:1,rate:0,amount:0}]}),[w,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{_()},[c]);let _=async()=>{if(c)try{let{data:e,error:t}=await v.O.from("clients").select("id, name, email, company").eq("business_id",c.id).order("name");if(t)throw t;m(e||[])}catch(e){console.error("Error fetching clients:",e)}},C=(e,t)=>e*t,I=()=>j.items.reduce((e,t)=>e+t.amount,0),O=(e,t,s)=>{let a=[...j.items];a[e]={...a[e],[t]:s},("quantity"===t||"rate"===t)&&(a[e].amount=C(a[e].quantity,a[e].rate)),b({...j,items:a})},S=e=>{if(j.items.length>1){let t=j.items.filter((t,s)=>s!==e);b({...j,items:t})}},k=async e=>{if(e.preventDefault(),c){N(!0);try{let e=I();if(null==t?void 0:t.id){let{error:s}=await v.O.from("invoices").update({client_id:j.client_id,title:j.title,description:j.description,due_date:j.due_date,issue_date:j.issue_date,payment_terms:j.payment_terms,currency:j.currency,status:j.status,notes:j.notes,amount:e,total_amount:e}).eq("id",t.id);if(s)throw s;await v.O.from("invoice_items").delete().eq("invoice_id",t.id);let{error:a}=await v.O.from("invoice_items").insert(j.items.map(e=>({invoice_id:t.id,description:e.description,quantity:e.quantity,rate:e.rate,amount:e.amount})));if(a)throw a;g.toast.success("Invoice updated successfully")}else{let{data:t,error:s}=await v.O.rpc("generate_invoice_number");if(s)throw s;let{data:a,error:r}=await v.O.from("invoices").insert({invoice_number:t,business_id:c.id,freelancer_id:c.id,client_id:j.client_id,title:j.title,description:j.description,due_date:j.due_date,issue_date:j.issue_date,payment_terms:j.payment_terms,currency:j.currency,status:j.status,notes:j.notes,amount:e,total_amount:e}).select().single();if(r)throw r;let{error:i}=await v.O.from("invoice_items").insert(j.items.map(e=>({invoice_id:a.id,description:e.description,quantity:e.quantity,rate:e.rate,amount:e.amount})));if(i)throw i;g.toast.success("Invoice created successfully")}s()}catch(e){g.toast.error(e.message||"Failed to save invoice")}finally{N(!1)}}};return(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:t?"Edit Invoice":"Create New Invoice"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"client",children:"Client *"}),(0,a.jsxs)(p.Ph,{value:j.client_id,onValueChange:e=>b({...j,client_id:e}),children:[(0,a.jsx)(p.i4,{children:(0,a.jsx)(p.ki,{placeholder:"Select a client"})}),(0,a.jsx)(p.Bw,{children:u.map(e=>(0,a.jsxs)(p.Ql,{value:e.id,children:[e.name," ",e.company&&"(".concat(e.company,")")]},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"title",children:"Title *"}),(0,a.jsx)(l.I,{id:"title",value:j.title,onChange:e=>b({...j,title:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"issue_date",children:"Issue Date"}),(0,a.jsx)(l.I,{id:"issue_date",type:"date",value:j.issue_date,onChange:e=>b({...j,issue_date:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"due_date",children:"Due Date"}),(0,a.jsx)(l.I,{id:"due_date",type:"date",value:j.due_date,onChange:e=>b({...j,due_date:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"payment_terms",children:"Payment Terms"}),(0,a.jsxs)(p.Ph,{value:j.payment_terms,onValueChange:e=>b({...j,payment_terms:e}),children:[(0,a.jsx)(p.i4,{children:(0,a.jsx)(p.ki,{})}),(0,a.jsxs)(p.Bw,{children:[(0,a.jsx)(p.Ql,{value:"Due on receipt",children:"Due on receipt"}),(0,a.jsx)(p.Ql,{value:"15 days",children:"15 days"}),(0,a.jsx)(p.Ql,{value:"30 days",children:"30 days"}),(0,a.jsx)(p.Ql,{value:"60 days",children:"60 days"}),(0,a.jsx)(p.Ql,{value:"90 days",children:"90 days"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"currency",children:"Currency"}),(0,a.jsxs)(p.Ph,{value:j.currency,onValueChange:e=>b({...j,currency:e}),children:[(0,a.jsx)(p.i4,{children:(0,a.jsx)(p.ki,{})}),(0,a.jsxs)(p.Bw,{children:[(0,a.jsx)(p.Ql,{value:"USD",children:"USD"}),(0,a.jsx)(p.Ql,{value:"EUR",children:"EUR"}),(0,a.jsx)(p.Ql,{value:"GBP",children:"GBP"}),(0,a.jsx)(p.Ql,{value:"CAD",children:"CAD"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"description",children:"Description"}),(0,a.jsx)(x.g,{id:"description",value:j.description,onChange:e=>b({...j,description:e.target.value}),rows:3})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(h._,{children:"Invoice Items"}),(0,a.jsxs)(n.z,{type:"button",onClick:()=>{b({...j,items:[...j.items,{description:"",quantity:1,rate:0,amount:0}]})},size:"sm",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Add Item"]})]}),(0,a.jsx)("div",{className:"space-y-2",children:j.items.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end",children:[(0,a.jsx)("div",{className:"col-span-5",children:(0,a.jsx)(l.I,{placeholder:"Description",value:e.description,onChange:e=>O(t,"description",e.target.value)})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(l.I,{placeholder:"Qty",type:"number",min:"0",step:"0.01",value:e.quantity,onChange:e=>O(t,"quantity",parseFloat(e.target.value)||0)})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(l.I,{placeholder:"Rate",type:"number",min:"0",step:"0.01",value:e.rate,onChange:e=>O(t,"rate",parseFloat(e.target.value)||0)})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(l.I,{value:e.amount.toFixed(2),readOnly:!0,className:"bg-gray-50"})}),(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>S(t),disabled:1===j.items.length,children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})})]},t))}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"text-lg font-semibold",children:["Total: ",j.currency," ",I().toFixed(2)]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(h._,{htmlFor:"notes",children:"Notes"}),(0,a.jsx)(x.g,{id:"notes",value:j.notes,onChange:e=>b({...j,notes:e.target.value}),rows:3})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:w,children:w?"Saving...":"Save Invoice"})]})]})})]})};var b=s(2959);let w=()=>{let{currentBusiness:e}=(0,y.i)(),[t,s]=(0,r.useState)(""),[h,x]=(0,r.useState)([]),[p,w]=(0,r.useState)(!0),[N,_]=(0,r.useState)(!1),[C,I]=(0,r.useState)();(0,r.useEffect)(()=>{e&&O()},[e]);let O=async()=>{if(e)try{let{data:t,error:s}=await v.O.from("invoices").select("\n          *,\n          clients (\n            name,\n            company\n          )\n        ").eq("business_id",e.id).order("created_at",{ascending:!1});if(s)throw s;x(t||[])}catch(e){console.error("Error fetching invoices:",e),g.toast.error("Failed to fetch invoices")}finally{w(!1)}},S=async e=>{try{let{data:t,error:s}=await v.O.from("invoice_items").select("*").eq("invoice_id",e.id);if(s)throw s;I({...e,items:t||[]}),_(!0)}catch(e){g.toast.error(e.message||"Failed to load invoice details")}},k=async e=>{if(confirm("Are you sure you want to delete this invoice?"))try{let{error:t}=await v.O.from("invoices").delete().eq("id",e);if(t)throw t;g.toast.success("Invoice deleted successfully"),O()}catch(e){g.toast.error(e.message||"Failed to delete invoice")}},z=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";case"sent":return"bg-blue-100 text-blue-800";case"viewed":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},R=h.filter(e=>e.invoice_number.toLowerCase().includes(t.toLowerCase())||e.title.toLowerCase().includes(t.toLowerCase())||e.clients.name.toLowerCase().includes(t.toLowerCase()));return e?N?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(j,{invoice:C,onSave:()=>{_(!1),I(void 0),O()},onCancel:()=>{_(!1),I(void 0)}})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoices"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage your invoices."})]}),(0,a.jsxs)(n.z,{onClick:()=>_(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Create Invoice"]})]}),(0,a.jsxs)(i.Zb,{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)(l.I,{placeholder:"Search invoices...",value:t,onChange:e=>s(e.target.value),className:"pl-10"})]})}),p?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading invoices..."})]}):0===R.length?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No invoices found."})}):(0,a.jsx)("div",{className:"space-y-4",children:R.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.invoice_number}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.clients.name," ",e.clients.company&&"(".concat(e.clients.company,")")]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium text-gray-900",children:[e.currency," ",e.total_amount.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Due: ",(0,b.WU)(new Date(e.due_date),"MMM dd, yyyy")]})]}),(0,a.jsx)(d.C,{className:z(e.status),children:e.status}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>S(e),children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>k(e.id),children:(0,a.jsx)(f.Z,{className:"w-4 h-4 text-red-500"})})]})]})]},e.id))})]})]}):(0,a.jsx)("div",{children:"Loading..."})}},3277:function(e,t,s){s.d(t,{C:function(){return l}});var a=s(3827);s(4090);var r=s(9769),i=s(2169);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)(n({variant:s}),t),...r})}},575:function(e,t,s){s.d(t,{z:function(){return o}});var a=s(3827),r=s(4090),i=s(9143),n=s(9769),l=s(2169);let d=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:o=!1,...c}=e,u=o?i.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(d({variant:r,size:n,className:s})),ref:t,...c})});o.displayName="Button"},5671:function(e,t,s){s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return n},aY:function(){return c},ll:function(){return d}});var a=s(3827),r=s(4090),i=s(2169);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},2782:function(e,t,s){s.d(t,{I:function(){return n}});var a=s(3827),r=s(4090),i=s(2169);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},2647:function(e,t,s){s.d(t,{_:function(){return o}});var a=s(3827),r=s(4090),i=s(4602),n=s(9769),l=s(2169);let d=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.f,{ref:t,className:(0,l.cn)(d(),s),...r})});o.displayName=i.f.displayName},8641:function(e,t,s){s.d(t,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return p},i4:function(){return m},ki:function(){return u}});var a=s(3827),r=s(4090),i=s(8161),n=s(3441),l=s(5159),d=s(9259),o=s(2169);let c=i.fC;i.ZA;let u=i.B4,m=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(i.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(i.JO,{asChild:!0,children:(0,a.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.xz.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})});f.displayName=i.u_.displayName;let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=i.$G.displayName;let x=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...l}=e;return(0,a.jsx)(i.h_,{children:(0,a.jsxs)(i.VY,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...l,children:[(0,a.jsx)(f,{}),(0,a.jsx)(i.l_,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})})});x.displayName=i.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=i.__.displayName;let p=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(i.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(i.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(i.eT,{children:r})]})});p.displayName=i.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=i.Z0.displayName},8685:function(e,t,s){s.d(t,{g:function(){return n}});var a=s(3827),r=s(4090),i=s(2169);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});n.displayName="Textarea"},2131:function(e,t,s){s.d(t,{H:function(){return d},a:function(){return o}});var a=s(3827),r=s(4090),i=s(9902),n=s(7907);let l=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,[s,d]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),f=(0,n.useRouter)();(0,r.useEffect)(()=>{let{data:{subscription:e}}=i.O.auth.onAuthStateChange((e,t)=>{var s;c(t),d(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),m(!1)});return i.O.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;c(s),d(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),m(!1)}),()=>e.unsubscribe()},[]);let h=async()=>{let{error:e}=await i.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/")}});if(e)throw e},x=async(e,t)=>{let{error:s}=await i.O.auth.signInWithPassword({email:e,password:t});return{error:s}},p=async(e,t,s)=>{let{error:a}=await i.O.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/"),data:{full_name:s}}});return{error:a}},v=async()=>{await i.O.auth.signOut(),f.push("/auth")};return(0,a.jsx)(l.Provider,{value:{user:s,session:o,loading:u,signInWithGoogle:h,signInWithEmail:x,signUpWithEmail:p,signOut:v,supabase:i.O},children:t})},o=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8494:function(e,t,s){s.d(t,{c:function(){return d},i:function(){return o}});var a=s(3827),r=s(4090),i=s(2131),n=s(9902);let l=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,{user:s}=(0,i.a)(),[d,o]=(0,r.useState)(null),[c,u]=(0,r.useState)([]),[m,f]=(0,r.useState)([]),[h,x]=(0,r.useState)(!0),p=async()=>{if(s)try{let{data:e,error:t}=await n.O.from("business_users").select("*").eq("user_id",s.id);if(t)throw t;if(f(e||[]),e&&e.length>0){let t=e.map(e=>e.business_id),{data:s,error:a}=await n.O.from("businesses").select("*").in("id",t);if(a)throw a;u(s||[]),!d&&s&&s.length>0&&o(s[0])}}catch(e){console.error("Error fetching businesses:",e)}finally{x(!1)}},v=async()=>{await p()},y=async e=>{if(d)try{let{error:t}=await n.O.from("businesses").update(e).eq("id",d.id);if(t)throw t;o({...d,...e}),await v()}catch(e){throw console.error("Error updating business:",e),e}};return(0,r.useEffect)(()=>{s?p():(u([]),o(null),f([]),x(!1))},[s]),(0,a.jsx)(l.Provider,{value:{currentBusiness:d,businesses:c,businessUsers:m,loading:h,switchBusiness:e=>{let t=c.find(t=>t.id===e);t&&o(t)},refreshBusinesses:v,updateBusiness:y},children:t})},o=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useBusiness must be used within a BusinessProvider");return e}},9902:function(e,t,s){s.d(t,{O:function(){return a}});let a=(0,s(3549).eI)("https://bsvctnxiaquebimrxvoo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzdmN0bnhpYXF1ZWJpbXJ4dm9vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NzE1MDEsImV4cCI6MjA2NDU0NzUwMX0._S6ZoYf5H44R5kvHL6I73lHGLJ1YP8P0tMHNOyfkeKU")},2169:function(e,t,s){s.d(t,{cn:function(){return i}});var a=s(3167),r=s(1367);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}}]);