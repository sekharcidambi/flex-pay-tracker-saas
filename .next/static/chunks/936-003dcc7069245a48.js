"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[936],{9936:function(e,s,a){a.d(s,{d:function(){return N}});var l=a(3827),i=a(4090),r=a(5671),n=a(575),t=a(2782),c=a(94),d=a(8670),o=a(1213),m=a(9295),h=a(489),x=a(684),u=a(2647),j=a(8685),v=a(8641),p=a(9902),y=a(8494),g=a(6288);let f=e=>{let{client:s,onSave:a,onCancel:c}=e,{currentBusiness:d}=(0,y.i)(),[o,m]=(0,i.useState)({name:(null==s?void 0:s.name)||"",email:(null==s?void 0:s.email)||"",company:(null==s?void 0:s.company)||"",phone:(null==s?void 0:s.phone)||"",address:(null==s?void 0:s.address)||"",preferred_currency:(null==s?void 0:s.preferred_currency)||"USD",notes:(null==s?void 0:s.notes)||""}),[h,x]=(0,i.useState)(!1),f=async e=>{if(e.preventDefault(),d){x(!0);try{if(null==s?void 0:s.id){let{error:e}=await p.O.from("clients").update(o).eq("id",s.id);if(e)throw e;g.toast.success("Client updated successfully")}else{let{error:e}=await p.O.from("clients").insert({...o,business_id:d.id,freelancer_id:d.id});if(e)throw e;g.toast.success("Client created successfully")}a()}catch(e){g.toast.error(e.message||"Failed to save client")}finally{x(!1)}}};return(0,l.jsxs)(r.Zb,{children:[(0,l.jsx)(r.Ol,{children:(0,l.jsx)(r.ll,{children:s?"Edit Client":"Add New Client"})}),(0,l.jsx)(r.aY,{children:(0,l.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u._,{htmlFor:"name",children:"Name *"}),(0,l.jsx)(t.I,{id:"name",value:o.name,onChange:e=>m({...o,name:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u._,{htmlFor:"email",children:"Email *"}),(0,l.jsx)(t.I,{id:"email",type:"email",value:o.email,onChange:e=>m({...o,email:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u._,{htmlFor:"company",children:"Company"}),(0,l.jsx)(t.I,{id:"company",value:o.company,onChange:e=>m({...o,company:e.target.value})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u._,{htmlFor:"phone",children:"Phone"}),(0,l.jsx)(t.I,{id:"phone",value:o.phone,onChange:e=>m({...o,phone:e.target.value})})]}),(0,l.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,l.jsx)(u._,{htmlFor:"address",children:"Address"}),(0,l.jsx)(t.I,{id:"address",value:o.address,onChange:e=>m({...o,address:e.target.value})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u._,{htmlFor:"currency",children:"Preferred Currency"}),(0,l.jsxs)(v.Ph,{value:o.preferred_currency,onValueChange:e=>m({...o,preferred_currency:e}),children:[(0,l.jsx)(v.i4,{children:(0,l.jsx)(v.ki,{})}),(0,l.jsxs)(v.Bw,{children:[(0,l.jsx)(v.Ql,{value:"USD",children:"USD"}),(0,l.jsx)(v.Ql,{value:"EUR",children:"EUR"}),(0,l.jsx)(v.Ql,{value:"GBP",children:"GBP"}),(0,l.jsx)(v.Ql,{value:"CAD",children:"CAD"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,l.jsx)(u._,{htmlFor:"notes",children:"Notes"}),(0,l.jsx)(j.g,{id:"notes",value:o.notes,onChange:e=>m({...o,notes:e.target.value}),rows:3})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,l.jsx)(n.z,{type:"button",variant:"outline",onClick:c,children:"Cancel"}),(0,l.jsx)(n.z,{type:"submit",disabled:h,children:h?"Saving...":"Save Client"})]})]})})]})},N=()=>{let{currentBusiness:e}=(0,y.i)(),[s,a]=(0,i.useState)(""),[u,j]=(0,i.useState)([]),[v,N]=(0,i.useState)(!0),[w,C]=(0,i.useState)(!1),[b,_]=(0,i.useState)();(0,i.useEffect)(()=>{e&&S()},[e]);let S=async()=>{if(e)try{let{data:s,error:a}=await p.O.from("clients").select("*").eq("business_id",e.id).order("created_at",{ascending:!1});if(a)throw a;j(s||[])}catch(e){console.error("Error fetching clients:",e),g.toast.error("Failed to fetch clients")}finally{N(!1)}},z=e=>{_(e),C(!0)},F=async e=>{if(confirm("Are you sure you want to delete this client?"))try{let{error:s}=await p.O.from("clients").delete().eq("id",e);if(s)throw s;g.toast.success("Client deleted successfully"),S()}catch(e){g.toast.error(e.message||"Failed to delete client")}},k=u.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())||e.email.toLowerCase().includes(s.toLowerCase())||e.company&&e.company.toLowerCase().includes(s.toLowerCase()));return e?w?(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsx)(f,{client:b,onSave:()=>{C(!1),_(void 0),S()},onCancel:()=>{C(!1),_(void 0)}})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Clients"}),(0,l.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your client relationships."})]}),(0,l.jsxs)(n.z,{onClick:()=>C(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,l.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Add Client"]})]}),(0,l.jsxs)(r.Zb,{className:"p-6",children:[(0,l.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,l.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,l.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,l.jsx)(t.I,{placeholder:"Search clients...",value:s,onChange:e=>a(e.target.value),className:"pl-10"})]})}),v?(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading clients..."})]}):0===k.length?(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-gray-600",children:"No clients found."})}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map(e=>(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"bg-blue-100 text-blue-600 p-2 rounded-lg",children:(0,l.jsx)(o.Z,{className:"w-5 h-5"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),e.company&&(0,l.jsx)("p",{className:"text-sm text-gray-500",children:e.company})]})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>z(e),children:(0,l.jsx)(m.Z,{className:"w-4 h-4"})}),(0,l.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>F(e.id),children:(0,l.jsx)(h.Z,{className:"w-4 h-4 text-red-500"})})]})]}),(0,l.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,l.jsx)(x.Z,{className:"w-4 h-4"}),e.email]}),e.phone&&(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.phone})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 gap-2 mb-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Currency"}),(0,l.jsx)("p",{className:"font-medium text-gray-900",children:e.preferred_currency})]})}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(n.z,{variant:"outline",size:"sm",className:"flex-1",children:"View Details"}),(0,l.jsx)(n.z,{variant:"outline",size:"sm",className:"flex-1",children:"New Invoice"})]})]},e.id))})]})]}):(0,l.jsx)("div",{children:"Loading..."})}}}]);